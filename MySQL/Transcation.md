# 事务
事务最经典的例子就是转账，A向B转账100元，那么A的余额减100，B的余额加100，这是一组操作（可以理解为在一个函数内），要么全部成功，要么全部失败。MySQL中并不是所有的引擎都支持事务，MyISAM是不支持事务的，InnoDB支持事务。
## 隔离性与隔离级别
当数据库上有多个事务同时执行的时候，就可能出现脏读，不可重复读，幻读的问题，为了解决这些问题，就有了隔离级别。
隔离性越好，意味着性能越差，因此，寻找性能与隔离性的平衡点十分重要。SQL的事务隔离级别包括：读未提交、读提交、可重复读、串行化。
* 读未提交，一个事务还没被提交时，它做的变更就能被别的事务看到。
* 读提交，一个事务提交后，它做的变更才会被别的事务看到。
* 可重复读，一个事务在执行过程中看到的数据，总是跟这个事务在启动时看到的数据是一致的。可重复读前提下，未提交的变更对其他事务也不可见。
* 串行化，读加读锁，写加写锁，出现锁冲突的时候，后访问的事务必须等前一个事务执行完成才能继续执行

![事务小练习](/asset/事务练习.png)
* 读未提交隔离级别下，V1的值为2，V2的值为2，V3的值为2。
* 读提交隔离级别下，V1的值为1，V2，V3为2，
* 可重复读级别下，V1，V2为1，V3为2
* 串行化级别下，V1，V2为1，V3为2

事务的执行过程中，MySQL会创建一个视图，访问的时候以视图的逻辑为准。读未提交与串行化不需要维护视图，读未提交直接返回记录的最新值，串行化通过加锁实现。读提交在执行SQL创建视图，可重复读在事务开启的时候创建视图
## 事务隔离的实现方式
以“可重复读”为例。

